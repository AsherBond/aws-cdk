"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/// !cdk-integ pragma:disable-update-workflow
const aws_cdk_lib_1 = require("aws-cdk-lib");
const integ = require("@aws-cdk/integ-tests-alpha");
const integ_tests_kubernetes_version_1 = require("./integ-tests-kubernetes-version");
const eks = require("aws-cdk-lib/aws-eks");
const cx_api_1 = require("aws-cdk-lib/cx-api");
const aws_lambda_1 = require("aws-cdk-lib/aws-lambda");
const customAspect = require("../lib/nodejs-aspect");
class EksAllHandlersInVpcStack extends aws_cdk_lib_1.Stack {
    constructor(scope, id) {
        super(scope, id);
        this.node.setContext(cx_api_1.EC2_RESTRICT_DEFAULT_SECURITY_GROUP, false);
        new eks.Cluster(this, 'EksAllHandlersInVpcStack', {
            ...(0, integ_tests_kubernetes_version_1.getClusterVersionConfig)(this),
            placeClusterHandlerInVpc: true,
        });
    }
}
const app = new aws_cdk_lib_1.App();
const stack = new EksAllHandlersInVpcStack(app, 'aws-cdk-eks-handlers-in-vpc-test');
aws_cdk_lib_1.Aspects.of(stack).add(customAspect.NodeJsAspect.modifyRuntimeTo(aws_lambda_1.Runtime.NODEJS_20_X));
new integ.IntegTest(app, 'aws-cdk-eks-handlers-in-vpc', {
    testCases: [stack],
    // Test includes assets that are updated weekly. If not disabled, the upgrade PR will fail.
    diffAssets: false,
});
app.synth();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWcuYXNwZWN0LWVrcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVnLmFzcGVjdC1la3MudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBNkM7QUFDN0MsNkNBQWtEO0FBQ2xELG9EQUFvRDtBQUNwRCxxRkFBMkU7QUFDM0UsMkNBQTJDO0FBQzNDLCtDQUF5RTtBQUN6RSx1REFBaUQ7QUFDakQscURBQXFEO0FBRXJELE1BQU0sd0JBQXlCLFNBQVEsbUJBQUs7SUFFMUMsWUFBWSxLQUFVLEVBQUUsRUFBVTtRQUNoQyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBRWpCLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLDRDQUFtQyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ2pFLElBQUksR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsMEJBQTBCLEVBQUU7WUFDaEQsR0FBRyxJQUFBLHdEQUF1QixFQUFDLElBQUksQ0FBQztZQUNoQyx3QkFBd0IsRUFBRSxJQUFJO1NBQy9CLENBQUMsQ0FBQztLQUNKO0NBQ0Y7QUFFRCxNQUFNLEdBQUcsR0FBRyxJQUFJLGlCQUFHLEVBQUUsQ0FBQztBQUV0QixNQUFNLEtBQUssR0FBRyxJQUFJLHdCQUF3QixDQUFDLEdBQUcsRUFBRSxrQ0FBa0MsQ0FBQyxDQUFDO0FBQ3BGLHFCQUFPLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsWUFBWSxDQUFDLGVBQWUsQ0FBQyxvQkFBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7QUFFdEYsSUFBSSxLQUFLLENBQUMsU0FBUyxDQUFDLEdBQUcsRUFBRSw2QkFBNkIsRUFBRTtJQUN0RCxTQUFTLEVBQUUsQ0FBQyxLQUFLLENBQUM7SUFDbEIsMkZBQTJGO0lBQzNGLFVBQVUsRUFBRSxLQUFLO0NBQ2xCLENBQUMsQ0FBQztBQUVILEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyAhY2RrLWludGVnIHByYWdtYTpkaXNhYmxlLXVwZGF0ZS13b3JrZmxvd1xuaW1wb3J0IHsgQXBwLCBBc3BlY3RzLCBTdGFjayB9IGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCAqIGFzIGludGVnIGZyb20gJ0Bhd3MtY2RrL2ludGVnLXRlc3RzLWFscGhhJztcbmltcG9ydCB7IGdldENsdXN0ZXJWZXJzaW9uQ29uZmlnIH0gZnJvbSAnLi9pbnRlZy10ZXN0cy1rdWJlcm5ldGVzLXZlcnNpb24nO1xuaW1wb3J0ICogYXMgZWtzIGZyb20gJ2F3cy1jZGstbGliL2F3cy1la3MnO1xuaW1wb3J0IHsgRUMyX1JFU1RSSUNUX0RFRkFVTFRfU0VDVVJJVFlfR1JPVVAgfSBmcm9tICdhd3MtY2RrLWxpYi9jeC1hcGknO1xuaW1wb3J0IHsgUnVudGltZSB9IGZyb20gJ2F3cy1jZGstbGliL2F3cy1sYW1iZGEnO1xuaW1wb3J0ICogYXMgY3VzdG9tQXNwZWN0IGZyb20gJy4uL2xpYi9ub2RlanMtYXNwZWN0JztcblxuY2xhc3MgRWtzQWxsSGFuZGxlcnNJblZwY1N0YWNrIGV4dGVuZHMgU3RhY2sge1xuXG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBBcHAsIGlkOiBzdHJpbmcpIHtcbiAgICBzdXBlcihzY29wZSwgaWQpO1xuXG4gICAgdGhpcy5ub2RlLnNldENvbnRleHQoRUMyX1JFU1RSSUNUX0RFRkFVTFRfU0VDVVJJVFlfR1JPVVAsIGZhbHNlKTtcbiAgICBuZXcgZWtzLkNsdXN0ZXIodGhpcywgJ0Vrc0FsbEhhbmRsZXJzSW5WcGNTdGFjaycsIHtcbiAgICAgIC4uLmdldENsdXN0ZXJWZXJzaW9uQ29uZmlnKHRoaXMpLFxuICAgICAgcGxhY2VDbHVzdGVySGFuZGxlckluVnBjOiB0cnVlLFxuICAgIH0pO1xuICB9XG59XG5cbmNvbnN0IGFwcCA9IG5ldyBBcHAoKTtcblxuY29uc3Qgc3RhY2sgPSBuZXcgRWtzQWxsSGFuZGxlcnNJblZwY1N0YWNrKGFwcCwgJ2F3cy1jZGstZWtzLWhhbmRsZXJzLWluLXZwYy10ZXN0Jyk7XG5Bc3BlY3RzLm9mKHN0YWNrKS5hZGQoY3VzdG9tQXNwZWN0Lk5vZGVKc0FzcGVjdC5tb2RpZnlSdW50aW1lVG8oUnVudGltZS5OT0RFSlNfMjBfWCkpO1xuXG5uZXcgaW50ZWcuSW50ZWdUZXN0KGFwcCwgJ2F3cy1jZGstZWtzLWhhbmRsZXJzLWluLXZwYycsIHtcbiAgdGVzdENhc2VzOiBbc3RhY2tdLFxuICAvLyBUZXN0IGluY2x1ZGVzIGFzc2V0cyB0aGF0IGFyZSB1cGRhdGVkIHdlZWtseS4gSWYgbm90IGRpc2FibGVkLCB0aGUgdXBncmFkZSBQUiB3aWxsIGZhaWwuXG4gIGRpZmZBc3NldHM6IGZhbHNlLFxufSk7XG5cbmFwcC5zeW50aCgpOyJdfQ==